(self.webpackChunkblog_vuepress=self.webpackChunkblog_vuepress||[]).push([[107],{8545:(s,e,a)=>{"use strict";a.r(e),a.d(e,{data:()=>n});const n={key:"v-f1f04634",path:"/git/git-advanced.html",title:"进阶探索",lang:"zh-CN",frontmatter:{},excerpt:"",headers:[{level:2,title:"基本概念",slug:"基本概念",children:[{level:3,title:"工作区（Working Directory）",slug:"工作区-working-directory",children:[]},{level:3,title:"本地版本库（Local Repository）",slug:"本地版本库-local-repository",children:[]},{level:3,title:"暂存区（stage）",slug:"暂存区-stage",children:[]},{level:3,title:"远程版本库（Remote Repository）",slug:"远程版本库-remote-repository",children:[]},{level:3,title:"以上概念之间的关系",slug:"以上概念之间的关系",children:[]},{level:3,title:"分支（Branch）",slug:"分支-branch",children:[]},{level:3,title:"主分支（Master）",slug:"主分支-master",children:[]},{level:3,title:"标签（Tag）",slug:"标签-tag",children:[]},{level:3,title:"HEAD",slug:"head",children:[]}]},{level:2,title:"操作文件",slug:"操作文件",children:[{level:3,title:"git add",slug:"git-add",children:[]},{level:3,title:"git commit",slug:"git-commit",children:[]},{level:3,title:"git mv",slug:"git-mv",children:[]},{level:3,title:"git rm",slug:"git-rm",children:[]},{level:3,title:"git status",slug:"git-status",children:[]}]},{level:2,title:"操作分支",slug:"操作分支",children:[{level:3,title:"git branch",slug:"git-branch",children:[]},{level:3,title:"git merge",slug:"git-merge",children:[]},{level:3,title:"git checkout",slug:"git-checkout",children:[]},{level:3,title:"git stash",slug:"git-stash",children:[]}]},{level:2,title:"操作历史",slug:"操作历史",children:[{level:3,title:"git log",slug:"git-log",children:[]},{level:3,title:"git cherry-pick",slug:"git-cherry-pick",children:[]},{level:3,title:"git reset",slug:"git-reset",children:[]},{level:3,title:"git rebase",slug:"git-rebase",children:[]},{level:3,title:"git revert",slug:"git-revert",children:[]},{level:3,title:"git diff",slug:"git-diff",children:[]},{level:3,title:"git reflog",slug:"git-reflog",children:[]}]},{level:2,title:"远程版本库连接",slug:"远程版本库连接",children:[{level:3,title:"git init",slug:"git-init",children:[]},{level:3,title:"git remote",slug:"git-remote",children:[]},{level:3,title:"git fetch",slug:"git-fetch",children:[]}]},{level:2,title:"问题排查",slug:"问题排查",children:[{level:3,title:"git blame",slug:"git-blame",children:[]},{level:3,title:"git bisect",slug:"git-bisect",children:[]}]},{level:2,title:"更多操作",slug:"更多操作",children:[{level:3,title:"git submodule",slug:"git-submodule",children:[]},{level:3,title:"git gc",slug:"git-gc",children:[]},{level:3,title:"git archive",slug:"git-archive",children:[]}]},{level:2,title:"总结",slug:"总结",children:[]}],filePathRelative:"git/git-advanced.md",git:{updatedTime:1621846301e3}}},9620:(s,e,a)=>{"use strict";a.r(e),a.d(e,{default:()=>i});const n=(0,a(6252).uE)('<h1 id="进阶探索"><a class="header-anchor" href="#进阶探索">#</a> 进阶探索</h1><h2 id="基本概念"><a class="header-anchor" href="#基本概念">#</a> 基本概念</h2><h3 id="工作区-working-directory"><a class="header-anchor" href="#工作区-working-directory">#</a> 工作区（Working Directory）</h3><p>就是你在电脑里能看到的目录，比如上文中的<code>test</code>文件夹就是一个工作区</p><h3 id="本地版本库-local-repository"><a class="header-anchor" href="#本地版本库-local-repository">#</a> 本地版本库（Local Repository）</h3><p>工作区有一个隐藏目录<code>.git</code>，这个不算工作区，而是Git的版本库。</p><p><img src="https://cdn.jsdelivr.net/npm/bedimages@1.0.3/img/210521-git-post02.jpg" alt=""></p><h3 id="暂存区-stage"><a class="header-anchor" href="#暂存区-stage">#</a> 暂存区（stage）</h3><p>本地版本库里存了很多东西，其中最重要的就是称为stage（或者叫index）的暂存区，还有Git为我们自动创建的第一个分支master，以及指向master的一个指针叫HEAD。</p><h3 id="远程版本库-remote-repository"><a class="header-anchor" href="#远程版本库-remote-repository">#</a> 远程版本库（Remote Repository）</h3><p>一般指的是Git服务器上所对应的仓库，本文的示例所在的github仓库就是一个远程版本库</p><h3 id="以上概念之间的关系"><a class="header-anchor" href="#以上概念之间的关系">#</a> 以上概念之间的关系</h3><p>工作区、暂存区、本地版本库、远程版本库之间几个常用的Git操作流程如下图所示：</p><p><img src="https://cdn.jsdelivr.net/npm/bedimages@1.0.3/img/210521-git-post03.jpg" alt=""></p><h3 id="分支-branch"><a class="header-anchor" href="#分支-branch">#</a> 分支（Branch）</h3><p>分支是为了将修改记录的整个流程分开存储，让分开的分支不受其它分支的影响，所以在同一个数据库里可以同时进行多个不同的修改</p><p><img src="https://cdn.jsdelivr.net/npm/bedimages@1.0.3/img/210521-git-post04.jpg" alt=""></p><h3 id="主分支-master"><a class="header-anchor" href="#主分支-master">#</a> 主分支（Master）</h3><p>前面提到过master是Git为我们自动创建的第一个分支，也叫主分支，其它分支开发完成后都要合并到master</p><p><img src="https://cdn.jsdelivr.net/npm/bedimages@1.0.3/img/210521-git-post05.jpg" alt=""></p><h3 id="标签-tag"><a class="header-anchor" href="#标签-tag">#</a> 标签（Tag）</h3><p>标签是用于标记特定的点或提交的历史，通常会用来标记发布版本的名称或版本号（如：publish/0.0.1），虽然标签看起来有点像分支，但打上标签的提交是固定的，不能随意的改动，参见上图中的1.0/2.0/3.0</p><h3 id="head"><a class="header-anchor" href="#head">#</a> HEAD</h3><p>HEAD指向的就是当前分支的最新提交</p><p><img src="https://cdn.jsdelivr.net/npm/bedimages@1.0.3/img/210521-git-post06.jpg" alt=""></p><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>以上概念了解的差不多，那就可以继续往下看，下面将以具体的操作类型来讲解Git的高阶用法</p></div><h2 id="操作文件"><a class="header-anchor" href="#操作文件">#</a> 操作文件</h2><h3 id="git-add"><a class="header-anchor" href="#git-add">#</a> git add</h3><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>添加文件到暂存区</p></div><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">git</span> <span class="token function">add</span> -i\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>通过此命令将打开交互式子命令系统，你将看到如下子命令</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>*** Commands ***\n  <span class="token number">1</span>: status       <span class="token number">2</span>: update       <span class="token number">3</span>: revert       <span class="token number">4</span>: <span class="token function">add</span> untracked\n  <span class="token number">5</span>: patch        <span class="token number">6</span>: <span class="token function">diff</span>         <span class="token number">7</span>: quit         <span class="token number">8</span>: <span class="token builtin class-name">help</span>\nWhat now<span class="token operator">&gt;</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>通过输入序列号或首字母可以选择相应的功能，具体的功能解释如下：</p><ul><li>status：功能上和git add -i相似，没什么鸟用</li><li>update：详见下方git add -u</li><li>revert：把已经添加到暂存区的文件从暂存区剔除，其操作方式和update类似</li><li>add untracked：可以把新增的文件添加到暂存区，其操作方式和update类似</li><li>patch：详见下方git add -p</li><li>diff：比较暂存区文件和本地版本库的差异，其操作方式和update类似</li><li>quit：退出git add -i命令系统</li><li>help：查看帮助信息</li></ul><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">git</span> <span class="token function">add</span> -p\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>直接进入交互命令中最有用的patch模式 这是交互命令中最有用的模式，其操作方式和update类似，选择后Git会显示这些文件的当前内容与本地版本库中的差异，然后您可以自己决定是否添加这些修改到暂存区，在命令行<code>Stage this hunk [y,n,q,a,d,e,?]?</code>后输入<code>y,n,q,a,d,e,?</code>其中一项选择操作方式，具体功能解释如下：</p><ul><li>y：接受修改</li><li>n：忽略修改</li><li>q：退出当前命令</li><li>a：添加修改</li><li>d：放弃修改</li><li>?：查看帮助信息</li></ul><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">git</span> <span class="token function">add</span> -u\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>直接进入交互命令中的update模式 它会先列出工作区修改或删除的文件列表，新增的文件不会被显示，在命令行Update&gt;&gt;后输入相应的列表序列号表示选中该项，回车继续选择，如果已选好，直接回车回到命令主界面</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">git</span> <span class="token function">add</span> --ignore-removal <span class="token builtin class-name">.</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>添加工作区修改或新增的文件列表，删除的文件不会被添加</p><h3 id="git-commit"><a class="header-anchor" href="#git-commit">#</a> git commit</h3><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>把暂存区的文件提交到本地版本库</p></div><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">git</span> commit -m <span class="token string">&#39;第一行提交原因&#39;</span> -m <span class="token string">&#39;第二行提交原因&#39;</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>不打开编辑器，直接在命令行中输入多行提交原因</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">git</span> commit -am <span class="token string">&#39;提交原因&#39;</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>将工作区修改或删除的文件提交到本地版本库，新增的文件不会被提交</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">git</span> commit --amend -m <span class="token string">&#39;提交原因&#39;</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>修改最新一条提交记录的提交原因</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">git</span> commit -C HEAD\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>将当前文件改动提交到HEAD或当前分支的历史ID</p><h3 id="git-mv"><a class="header-anchor" href="#git-mv">#</a> git mv</h3><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>移动或重命名文件、目录</p></div><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">git</span> <span class="token function">mv</span> a.md b.md -f\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>将a.md重命名为b.md，同时添加变动到暂存区，加-f参数可以强制重命名，相比用mv a.md b.md命令省去了git add操作</p><h3 id="git-rm"><a class="header-anchor" href="#git-rm">#</a> git rm</h3><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>从工作区和暂存区移除文件</p></div><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">git</span> <span class="token function">rm</span> b.md\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>从工作区和暂存区移除文件b.md，同时添加变动到暂存区，相比用rm b.md命令省去了git add操作</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">git</span> <span class="token function">rm</span> src/ -r\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>允许从工作区和暂存区移除目录</p><h3 id="git-status"><a class="header-anchor" href="#git-status">#</a> git status</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">git</span> status -s\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>以简短方式查看工作区和暂存区文件状态，示例如下：</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>M demo.html\n?? test.html\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">git</span> status --ignored\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>查看工作区和暂存区文件状态，包括被忽略的文件</p><h2 id="操作分支"><a class="header-anchor" href="#操作分支">#</a> 操作分支</h2><h3 id="git-branch"><a class="header-anchor" href="#git-branch">#</a> git branch</h3><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>查看、创建、删除分支</p></div><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">git</span> branch -a\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>查看本地版本库和远程版本库上的分支列表</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">git</span> branch -r\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>查看远程版本库上的分支列表，加上-d参数可以删除远程版本库上的分支</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">git</span> branch -D\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>分支未提交到本地版本库前强制删除分支</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">git</span> branch -vv\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>查看带有最后提交id、最近提交原因等信息的本地版本库分支列表</p><h3 id="git-merge"><a class="header-anchor" href="#git-merge">#</a> git merge</h3><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>将其它分支合并到当前分支</p></div><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">git</span> merge --squash\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>将待合并分支上的commit合并成一个新的commit放入当前分支，适用于待合并分支的提交记录不需要保留的情况</p><p><img src="https://cdn.jsdelivr.net/npm/bedimages@1.0.3/img/210521-git-post07.gif" alt=""></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">git</span> merge --no-ff\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>默认情况下，Git执行&quot;快进式合并&quot;（fast-farward merge），会直接将Master分支指向Develop分支，使用--no-ff参数后，会执行正常合并，在Master分支上生成一个新节点，保证版本演进更清晰。</p><p><img src="https://cdn.jsdelivr.net/npm/bedimages@1.0.3/img/210521-git-post08.jpg" alt=""></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">git</span> merge --no-edit\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>在没有冲突的情况下合并，不想手动编辑提交原因，而是用Git自动生成的类似Merge branch &#39;test&#39;的文字直接提交</p><h3 id="git-checkout"><a class="header-anchor" href="#git-checkout">#</a> git checkout</h3><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>切换分支</p></div><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">git</span> checkout -b daily/0.0.1\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>创建daily/0.0.1分支，同时切换到这个新创建的分支</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">git</span> checkout HEAD demo.html\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>从本地版本库的HEAD（也可以是提交ID、分支名、Tag名） 历史中检出demo.html覆盖当前工作区的文件，如果省略HEAD则是从暂存区检出</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">git</span> checkout --orphan new_branch\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>这个命令会创建一个全新的，完全没有历史记录的新分支，但当前源分支上所有的最新文件都还在，真是强迫症患者的福音，但这个新分支必须做一次git commit操作后才会真正成为一个新分支。</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">git</span> checkout -p other_branch\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>这个命令主要用来比较两个分支间的差异内容，并提供交互式的界面来选择进一步的操作，这个命令不仅可以比较两个分支间的差异，还可以比较单个文件的差异。</p><h3 id="git-stash"><a class="header-anchor" href="#git-stash">#</a> git stash</h3><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>在Git的栈中保存当前修改或删除的工作进度，当你在一个分支里做某项功能开发时，接到通知把昨天已经测试完没问题的代码发布到线上，但这时你已经在这个分支里加入了其它未提交的代码，这个时候就可以把这些未提交的代码存到栈里。</p></div><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">git</span> stash\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>将未提交的文件保存到Git栈中</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">git</span> stash list\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>查看栈中保存的列表</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">git</span> stash show stash@<span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">}</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>显示栈中其中一条记录</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">git</span> stash drop stash@<span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">}</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>移除栈中其中一条记录</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">git</span> stash pop\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>从Git栈中检出最新保存的一条记录，并将它从栈中移除</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">git</span> stash apply stash@<span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">}</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>从Git栈中检出其中一条记录，但不从栈中移除</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">git</span> stash branch new_banch\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>把当前栈中最近一次记录检出并创建一个新分支</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">git</span> stash <span class="token function">clear</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>清空栈里的所有记录</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">git</span> stash create\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>为当前修改或删除的文件创建一个自定义的栈并返回一个ID，此时并未真正存储到栈里</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">git</span> stash store xxxxxx\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>将create方法里返回的ID放到store后面，此时在栈里真正创建了一个记录，但当前修改或删除的文件并未从工作区移除</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">git</span> stash create\n09eb9a97ad632d0825be1ece361936d1d0bdb5c7\n$ <span class="token function">git</span> stash store09eb9a97ad632d0825be1ece361936d1d0bdb5c7\n$ <span class="token function">git</span> stash list\nstash@<span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">}</span>: Created via<span class="token string">&quot;git stash store&quot;</span><span class="token builtin class-name">.</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="操作历史"><a class="header-anchor" href="#操作历史">#</a> 操作历史</h2><h3 id="git-log"><a class="header-anchor" href="#git-log">#</a> git log</h3><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>显示提交历史记录</p></div><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">git</span> log -p\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>显示带提交差异对比的历史记录</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">git</span> log demo.html\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>显示demo.html文件的历史记录</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">git</span> log --since<span class="token operator">=</span><span class="token string">&quot;2 weeks ago&quot;</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>显示2周前开始到现在的历史记录，其它时间可以类推</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">git</span> log --before<span class="token operator">=</span><span class="token string">&quot;2 weeks ago&quot;</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>显示截止到2周前的历史记录，其它时间可以类推</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">git</span> log -10\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>显示最近10条历史记录</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">git</span> log f5f630a<span class="token punctuation">..</span>HEAD\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>显示从提交IDf5f630a到HEAD之间的记录，HEAD可以为空或其它提交ID</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">git</span> log --pretty<span class="token operator">=</span>oneline\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>在一行中输出简短的历史记录</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">git</span> log --pretty<span class="token operator">=</span>format:<span class="token string">&quot;%h&quot;</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>格式化输出历史记录</p><p>Git用各种placeholder来决定各种显示内容，我挑几个常用的显示如下：</p><ul><li>%H: commit hash</li><li>%h: 缩短的commit hash</li><li>%T: tree hash</li><li>%t: 缩短的 tree hash</li><li>%P: parent hashes</li><li>%p: 缩短的 parent hashes</li><li>%an: 作者名字</li><li>%aN: mailmap的作者名</li><li>%ae: 作者邮箱</li><li>%ad: 日期 (--date= 制定的格式)</li><li>%ar: 日期, 相对格式(1 day ago)</li><li>%cn: 提交者名字%ce: 提交者 email</li><li>%cd: 提交日期 (--date= 制定的格式)</li><li>%cr: 提交日期, 相对格式(1 day ago)</li><li>%d: ref名称</li><li>%s: commit信息标题</li><li>%b: commit信息内容</li><li>%n: 换行</li></ul><h3 id="git-cherry-pick"><a class="header-anchor" href="#git-cherry-pick">#</a> git cherry-pick</h3><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>合并分支的一条或几条提交记录到当前分支末梢</p></div><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">git</span> cherry-pick170a305\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>合并提交<code>ID170a305</code>到当前分支末梢</p><h3 id="git-reset"><a class="header-anchor" href="#git-reset">#</a> git reset</h3><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>将当前的分支重设（reset）到指定的<code>&lt;commit&gt;</code>或者<code>HEAD</code></p></div><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">git</span> reset --mixed <span class="token operator">&lt;</span>commit<span class="token operator">&gt;</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p><code>--mixed</code>是不带参数时的默认参数，它退回到某个版本，保留文件内容，回退提交历史</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">git</span> reset --soft <span class="token operator">&lt;</span>commit<span class="token operator">&gt;</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>暂存区和工作区中的内容不作任何改变，仅仅把HEAD指向<code>&lt;commit&gt;</code></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">git</span> reset --hard <span class="token operator">&lt;</span>commit<span class="token operator">&gt;</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>自从<code>&lt;commit&gt;</code>以来在工作区中的任何改变都被丢弃，并把HEAD指向<code>&lt;commit&gt;</code></p><h3 id="git-rebase"><a class="header-anchor" href="#git-rebase">#</a> git rebase</h3><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>重新定义分支的版本库状态</p></div><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">git</span> rebase branch_name\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>合并分支，这跟merge很像，但还是有本质区别，看下图：</p><p><img src="https://cdn.jsdelivr.net/npm/bedimages@1.0.3/img/210521-git-post09.jpg" alt=""></p><p>合并过程中可能需要先解决冲突，然后执行<code>git rebase --continue</code></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">git</span> rebase -i HEAD~~\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>打开文本编辑器，将看到从HEAD到HEAD~~的提交如下</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>pick 9a54fd4 添加commit的说明\npick 0d4a808 添加pull的说明\n<span class="token comment"># Rebase 326fc9f..0d4a808 onto d286baa</span>\n<span class="token comment">#</span>\n<span class="token comment"># Commands:</span>\n<span class="token comment">#  p, pick = use commit</span>\n<span class="token comment">#  r, reword = use commit, but edit the commit message</span>\n<span class="token comment">#  e, edit = use commit, but stop for amending</span>\n<span class="token comment">#  s, squash = use commit, but meld into previous commit</span>\n<span class="token comment">#  f, fixup = like &quot;squash&quot;, but discard this commit&#39;s log message</span>\n<span class="token comment">#  x, exec = run command (the rest of the line) using shell</span>\n<span class="token comment">#</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>将第一行的pick改成Commands中所列出来的命令，然后保存并退出，所对应的修改将会生效。如果移动提交记录的顺序，将改变历史记录中的排序。</p><h3 id="git-revert"><a class="header-anchor" href="#git-revert">#</a> git revert</h3><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>撤销某次操作，此次操作之前和之后的commit和history都会保留，并且把这次撤销作为一次最新的提交</p></div><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">git</span> revert HEAD\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>撤销前一次提交操作</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">git</span> revert HEAD --no-edit\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>撤销前一次提交操作，并以默认的Revert &quot;xxx&quot;为提交原因</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">git</span> revert -n HEAD\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>需要撤销多次操作的时候加-n参数，这样不会每次撤销操作都提交，而是等所有撤销都完成后一起提交</p><h3 id="git-diff"><a class="header-anchor" href="#git-diff">#</a> git diff</h3><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>查看工作区、暂存区、本地版本库之间的文件差异，用一张图来解释</p></div><p><img src="https://cdn.jsdelivr.net/npm/bedimages@1.0.3/img/210521-git-post10.jpg" alt=""></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">git</span> <span class="token function">diff</span> --stat\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>通过--stat参数可以查看变更统计数据</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>test.md <span class="token operator">|</span><span class="token number">1</span>-\n1file changed,1deletion<span class="token punctuation">(</span>-<span class="token punctuation">)</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="git-reflog"><a class="header-anchor" href="#git-reflog">#</a> git reflog</h3><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>reflog可以查看所有分支的所有操作记录（包括commit和reset的操作、已经被删除的commit记录，跟git log的区别在于它不能查看已经删除了的commit记录</p></div><h2 id="远程版本库连接"><a class="header-anchor" href="#远程版本库连接">#</a> 远程版本库连接</h2><p>如果在GitHub项目初始化之前，文件已经存在于本地目录中，那可以在本地初始化本地版本库，再将本地版本库跟远程版本库连接起来</p><h3 id="git-init"><a class="header-anchor" href="#git-init">#</a> git init</h3><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>在本地目录内部会生成.git文件夹</p></div><h3 id="git-remote"><a class="header-anchor" href="#git-remote">#</a> git remote</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">git</span> remote -v\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>不带参数，列出已经存在的远程分支，加上-v列出详细信息，在每一个名字后面列出其远程url</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">git</span> remote <span class="token function">add</span> origin https://github.com/your-username/test.git\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>添加一个新的远程仓库，指定一个名字，以便引用后面带的URL</p><h3 id="git-fetch"><a class="header-anchor" href="#git-fetch">#</a> git fetch</h3><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>将远程版本库的更新取回到本地版本库</p></div><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">git</span> fetch origin daily/0.0.1\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>默认情况下，git fetch取回所有分支的更新。如果只想取回特定分支的更新，可以指定分支名。</p><h2 id="问题排查"><a class="header-anchor" href="#问题排查">#</a> 问题排查</h2><h3 id="git-blame"><a class="header-anchor" href="#git-blame">#</a> git blame</h3><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>查看文件每行代码块的历史信息</p></div><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">git</span> blame -L1,10demo.html\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>截取demo.html文件1-10行历史信息</p><h3 id="git-bisect"><a class="header-anchor" href="#git-bisect">#</a> git bisect</h3><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>二分查找历史记录，排查BUG</p></div><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">git</span> bisect start\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>开始二分查找</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">git</span> bisect bad\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>标记当前二分提交ID为有问题的点</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">git</span> bisect good\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>标记当前二分提交ID为没问题的点</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">git</span> bisect reset\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>查到有问题的提交ID后回到原分支</p><h2 id="更多操作"><a class="header-anchor" href="#更多操作">#</a> 更多操作</h2><h3 id="git-submodule"><a class="header-anchor" href="#git-submodule">#</a> git submodule</h3><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>通过 Git 子模块可以跟踪外部版本库，它允许在某一版本库中再存储另一版本库，并且能够保持2个版本库完全独立</p></div><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">git</span> submodule <span class="token function">add</span> https://github.com/your-username/demo.git demo\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>将demo仓库添加为子模块</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">git</span> submodule update demo\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>更新子模块demo</p><h3 id="git-gc"><a class="header-anchor" href="#git-gc">#</a> git gc</h3><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>运行Git的垃圾回收功能，清理冗余的历史快照</p></div><h3 id="git-archive"><a class="header-anchor" href="#git-archive">#</a> git archive</h3><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>将加了tag的某个版本打包提取</p></div><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">git</span> archive -v --format<span class="token operator">=</span>zip v0.1 <span class="token operator">&gt;</span> v0.1.zip\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>--format表示打包的格式，如zip，-v表示对应的tag名，后面跟的是tag名，如v0.1。</p><h2 id="总结"><a class="header-anchor" href="#总结">#</a> 总结</h2><p>本文只是对Git的所有功能中的部分实用功能做了一次实操，Git非常强大，还有很多功能有待我们去发现，限于本文篇幅，咱就此打住吧，预知更多好用功能，请善用谷歌。</p>',223),i={render:function(s,e){return n}}}}]);